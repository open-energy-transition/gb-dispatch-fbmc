# SPDX-FileCopyrightText: gb-dispatch-model contributors
#
# SPDX-License-Identifier: CC0-1.0

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#run
run:
  name: "GB"

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#foresight
foresight: overnight

fbmc:
  enable: true


scenario:
  clusters:
  - clustered
  opts:
  - ""
  sector_opts:
  - ""
  planning_horizons:
  - 2035 # approx average of the year range for our runs

snapshots:
  start: "2013-01-01"
  end: "2014-01-01"
  inclusive: 'left'

atlite:
  default_cutout: europe-2013-sarah3-era5
  cutouts:
    # use 'base' to determine geographical bounds and time span from config
    # base:
      # module: era5
    europe-2013-sarah3-era5:
      module: [sarah, era5] # in priority order
      x: [-12., 42.]
      y: [33., 72.]
      dx: 0.3
      dy: 0.3
      time: ['2013', '2013']
      # features: []
      # sarah_dir: ""

data:
  osm:
    source: archive
    version: "0.7"

energy:
  energy_totals_year: 2013

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#countries
countries:
- AT
- BE
- CH
- CZ
- DE
- DK
- ES
- FI
- FR
- GB
- IE
- IT
- LU
- NL
- "NO"
- PL
- PT
- SE
- SI

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#clustering
clustering:
  focus_weights: {NL: 0.01, "NO": 0.01, BE: 0.01, DK: 0.01, IE: 0.02, FR: 0.03, GB: 0.91}
  mode: gb_shapes
  consider_efficiency_classes: false
  aggregation_strategies:
    generators:
      committable: any  # From default config
      ramp_limit_up: max  # From default config
      ramp_limit_down: max  # From default config
      set: first  # Preserve 'set' column (CHP, PP, Store) during aggregation
  overwrite_custom_onshore_clusters: true
  simplify_network:
    to_substations: false
    remove_stubs: false
    remove_stubs_across_borders: false

renewable:
  hydro:
    cutout: default
    carriers: [PHS, hydro]

conventional:
  nuclear:
    max_annual_capacity_factor: 1
    min_annual_capacity_factor: 0.50

costs:
  GBP_to_EUR: 1.1632 # average in 2021: https://www.exchangerates.org.uk/GBP-EUR-spot-exchange-rates-history-2021.html#:~:text=This%20is%20the%20British%20Pound,rate%20in%202021%3A%201.1632%20EUR.
  GBP_to_USD: 1.3757 # average in 2021: https://www.exchangerates.org.uk/GBP-USD-spot-exchange-rates-history-2021.html#:~:text=Average%20exchange%20rate%20in%202021,USD%20on%2008%20Dec%202021.
  relevant_cost_columns: ["CO2 intensity", "VOM", "FOM", "investment", "efficiency", "lifetime", "discount rate", "fuel"]
  marginal_cost_columns: ["CO2 intensity", "VOM", "efficiency", "fuel"]
  add_cols:
    fes_powerplants: {}
    regional_H2_storage_capacity_inc_eur:
      set: Store
      carrier: hydrogen
    regional_grid_electrolysis_capacities_inc_eur:
      set: Other
      carrier: electrolysis
  default_characteristics:
    # Ensure all required columns exist with defaults
    efficiency:
      data: 1
      unit: ""
    lifetime:
      data: 25.0
      unit: "years"
    marginal_cost:
      data: 0.0
      unit: "GBP/MWh"
    FOM:
      data: 0.0
      unit: "GBP/MW"
    VOM:
      data: 0.0
      unit: "GBP/MWh"
    fuel:
      data: 0.0
      unit: "GBP/MWh"
    CO2 intensity:
      data: 0.0
      unit: "tCO2/MWh_th"
    investment:
      data: 0.0
      unit: "GBP/MW"
    discount rate:
      data: 0.07
      unit: ""
  carrier_gap_filling:
    "CO2 intensity":
      CCGT: gas
      OCGT: gas
      engine: gas
      coal: coal
      oil: oil
    fuel:
      CCGT: gas
      OCGT: gas
      engine: gas
      coal: coal
      oil: oil
      biomass: biomass
      waste: biomass
    default:
      CCGT PP: CCGT
      OCGT PP: OCGT
      CCGT CHP: central gas CHP
      OCGT CHP: central gas CHP
      PHS Store: PHS
      battery Store: battery storage
      biomass PP: biomass
      biomass CHP: biomass CHP
      coal PP: coal
      coal CHP: central coal CHP
      engine PP: central gas CHP # `direct firing gas` is a better fit but the data is spurious
      engine CHP: central gas CHP
      geothermal PP: geothermal
      hydrogen turbine PP: central hydrogen CHP
      hydrogen turbine CHP: central hydrogen CHP
      hydrogen fuel cell PP: fuel cell
      nuclear PP: nuclear
      offwind PP: offwind
      oil PP: oil
      oil CHP: oil
      onwind PP: onwind
      ror PP: hydro
      solar PP: solar
      waste PP: biomass
      waste CHP: waste CHP
      hydro PP: hydro
      hydrogen Store: hydrogen storage tank type 1 including compressor
      electrolysis Other: electrolysis

  fes_VOM_carrier_mapping:
    battery Store: Storage-Battery
    biomass PP: Biomass-Biomass
    biomass CHP: Biomass-Biomass CHP
    CCGT PP: Gas-CCGT
    CCGT CHP: Gas-Gas CHP
    coal PP: Coal-Coal
    coal CHP: Coal-Coal CHP
    engine CHP: Gas-Gas CHP
    engine PP: Gas-Gas Reciprocating Engines
    hydro PP: Hydro-Hydro
    hydrogen turbine PP: Low Carbon-Hydrogen
    hydrogen fuel cell PP: Storage-Fuel Cells
    hydrogen turbine CHP: Gas-Gas CHP # there is no hydrogen CHP costs in FES
    marine PP: Marine-Marine
    OCGT PP: Gas-OCGT
    OCGT CHP: Gas-Gas CHP
    offwind-dc PP: Offshore Wind-Offshore Wind
    oil PP: Other Thermal-Fuel Oil
    onwind PP: Onshore Wind-Onshore Wind
    nuclear PP: Nuclear-Nuclear
    PHS Store: Storage-Pumped Hydro
    solar PP: Solar-Solar PV
    waste PP: Waste-Waste
    waste CHP: Waste-Waste CHP
  fes_fuel_carrier_mapping:
    biomass PP: Biomass-Biomass
    biomass CHP: Biomass-Biomass CHP
    CCGT PP: Gas-CCGT
    CCGT CHP: Gas-CCGT CHP
    coal PP: Coal-Coal
    coal CHP: Coal-Coal CHP
    engine PP: Gas-Gas Reciprocating Engines
    engine CHP: Gas-Engine CHP
    OCGT PP: Gas-OCGT
    OCGT CHP: Gas-GT CHP
    hydrogen turbine PP: Low Carbon-Hydrogen
    hydrogen fuel cell PP: Storage-Fuel Cells
    hydrogen turbine CHP: Gas-Gas CHP # there is no hydrogen CHP costs in FES
    oil PP: Gasoil-Steam Oil
    waste PP: WoodPellets-Waste
    waste CHP: Gas-Waste CHP
  voll: 6000 #£/MWh - based on `value_of_lost_load` from (https://www.nationalgrid.com/sites/default/files/documents/Long-term%20Market%20and%20Network%20Constraint%20Modelling.pdf)

low_carbon_register:
  carrier_mapping:
    Offshore Wind: offwind-dc
    Onshore Wind: onwind
    Solar PV: solar
    Energy from Waste: waste
    Biomass Conversion: biomass
    Dedicated Biomass: biomass

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#solving
solving:
  options:
    clip_p_max_pu: 1.e-2
    load_shedding: false
    curtailment_mode: false
    noisy_costs: true
    skip_iterations: true
    rolling_horizon: false
    transmission_losses: 0
    custom_extra_functionality: "../data/custom_extra_functionality.py"
  solver:
    name: gurobi
    options: gurobi-default
  solver_options:
    gurobi-default:
      threads: 4 # limit threads for stable local runs

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#electricity
electricity:
  voltages: [132, 220., 275., 300., 330., 380., 400., 500., 750.]
  base_network: osm
  powerplants_filter: (DateOut >= 2020 or DateOut != DateOut) and not (Country == 'Germany' and Fueltype == 'Nuclear')
  extendable_carriers:
    Generator: []
    Store: []
  conventional_carriers: [nuclear, oil, OCGT, CCGT, engine, coal, waste, geothermal, biomass]
  renewable_carriers: [solar, onwind, offwind-dc, hydro]

# docs in https://pypsa-eur.readthedocs.io/en/latest/configuration.html#electricity
lines:
  types:
    275.: Al/St 240/40 3-bundle 300.0 # closest of correct size

# Simplified CHP configuration for GB model (electricity-only)
# CHPs are modeled as generators with minimum operation constraints based on heat demand
chp:
  enable: true  # Enable simplified CHP constraints
  heat_to_power_ratio: 1.5  # Heat-to-power ratio (c_b coefficient) - typical for gas CHPs
  min_operation_level: 0.3  # Minimum operation level when running (30% of capacity)
  shutdown_threshold: 0.1  # Heat demand threshold below which CHPs can shut down completely (fraction of peak demand)

urls:
  gb-etys-boundaries: https://api.neso.energy/dataset/997f4820-1ad4-499b-b1fe-4b8d3d7fbc72/resource/e914fcec-1dc9-4f1f-97e7-59c0d9521bea/download/etys-boundary-gis-data-mar25.zip
  transmission-availability-2020: https://www.neso.energy/document/177156/download
  transmission-availability-2021: https://www.neso.energy/document/211021/download
  transmission-availability-2022: https://www.neso.energy/document/267701/download
  transmission-availability-2023: https://www.neso.energy/document/289196/download
  transmission-availability-2024: https://www.neso.energy/document/324226/download
  fes-workbook: https://www.neso.energy/document/321051/download # FES 2024 workbook
  fes-costing-workbook: https://www.neso.energy/document/181961/download
  dukes-5.11: https://assets.publishing.service.gov.uk/media/688cb64ee8ba9507fc1b0953/DUKES_5.11.xlsx
  gsp-coordinates: https://api.neso.energy/dataset/963525d6-5d83-4448-a99c-663f1c76330a/resource/21c2b09c-24ff-4837-a3b1-b6aea88f8124/download/fes2024_regional_breakdown_gsp_info.csv
  eur-supply-table: https://api.neso.energy/dataset/bd83ce0b-7b1e-4ff2-89e8-12d524c34d99/resource/7902b197-ada0-47ae-bd2e-db566a8d0fab/download/fes2024_es2_v001.csv
  etys: https://www.neso.energy/document/286591/download # ETYS November 2023
  low-carbon-contracts: https://dp.lowcarboncontracts.uk/dataset/8e8ca0d5-c774-4dc8-a079-347f1c180c0f/resource/5279a55d-4996-4b1e-ba07-f411d8fd31f0/download/actual_cfd_generation_and_avoided_ghg_emissions.csv
  eur_H2_demand_today: https://observatory.clean-hydrogen.europa.eu/sites/default/files/2025-09/Hydrogen%20demand%202024%20%28Update%202025%29.xlsx # 2024 data
target_crs: "EPSG:27700"

# Manual region merging configuration
region_operations:
  area_loss_tolerance_percent: 0.01 # percentage of area loss tolerated when splitting regions
  min_region_area: 1000000 # minimum area of a region in square meters (1 km²) for keeping it after splitting
  # Regions to split before merging
  filter_boundaries_using_capabilities: false # if True, use only boundaries explicitly mentioned in the ETYS report.
  splits:
  - region: 3
    type: "vertical"
    coordinate: -2.48
  - region: 2
    type: "vertical"
    coordinate: -1.93
  - region: 9
    type: "vertical"
    coordinate: -2.48
  - region: 11
    type: "horizontal"
    coordinate: 53.1

  # Groups of regions to merge together
  merge_groups:
  - id: 1
    merge: [0]
    TO: NGET
  - id: 2
    merge: [64, 63, 90, 91]
    TO: NGET
  - id: 3
    merge: [1, '2w']
    TO: NGET
  - id: 4
    merge: ['2e']
    TO: NGET
  - id: 5
    merge: ['3e', '3ws', 8, 4]
    TO: NGET
  - id: 6
    merge: ['9e']
    TO: NGET
  - id: 7
    merge: [5, '3wn', 6, 7, '9w']
    TO: NGET
  - id: 8
    merge: [48, 51, 49]
    TO: NGET
  - id: 9
    merge: [65, 66, 74, 73, 72, 67, 68, 69, 59, 60, 61, 62]
    TO: NGET
  - id: 10
    merge: [50, 52, 53, 54, 55, 56, 75, 70, 71, 57, 58, 93, 94, 95, 96, 97]
    TO: NGET
  - id: 11
    merge: [47, 98]
    TO: NGET
  - id: 12
    merge: [46, 44, 45]
    TO: NGET
  - id: 13
    merge: [43]
    TO: NGET
  - id: 14
    merge: [10, 76, 11s]
    TO: NGET
  - id: 15
    merge: [11n]
    TO: NGET
  - id: 16
    merge: [40, 38, 41]
    TO: NGET
  - id: 17
    merge: [12]
    TO: NGET
  - id: 18
    merge: [13]
    TO: NGET
  - id: 19
    merge: [39, 42]
    TO: NGET
  - id: 20
    merge: [15, 16, 17]
    TO: NGET
  - id: 21
    merge: [18]
    TO: NGET
  - id: 22
    merge: [14, 78]
    TO: NGET

  - id: 23
    merge: [19]
    TO: SPTL
  - id: 24
    merge: [20]
    TO: SPTL

  - id: 25
    merge: [21]
    TO: SHETL
  - id: 26
    merge: [31, 37]
    TO: SHETL
  - id: 27
    merge: [32, 33, 85, 86, 87, 88, 89]
    TO: SHETL
  - id: 28
    merge: [22, 23, 24, 26, 27, 28, 29, 30, 25, 83, 84]
    TO: SHETL
  - id: 29
    merge: [34, 35, 36, 92]
    TO: SHETL

  - id: 30
    merge: [79, 80, 81, 82]
    TO: N-IRL

  - id: 31
    merge: [77]
    TO: NGET

  # List for merging regions into neighbouring countries
  add_group_to_neighbour:
    IE: ["GB 30"]

  etys_boundaries_lines:
    B3b:
    - bus0: 28
      bus1: 25
    - bus0: 28
      bus1: 23
    B4:
    - bus0: 25
      bus1: 24
    B5:
    - bus0: 24
      bus1: 23
    B6:
    - bus0: 23
      bus1: 21
    B7a:
    - bus0: 20
      bus1: 15
    - bus0: 20
      bus1: 16
    - bus0: 16
      bus1: 21
    B8:
    - bus0: 14
      bus1: 17
    - bus0: 14
      bus1: 15
    - bus0: 14
      bus1: 16
    - bus0: 13
      bus1: 16
    B9:
    - bus0: 14
      bus1: 6
    - bus0: 14
      bus1: 7
    - bus0: 14
      bus1: 5
    - bus0: 13
      bus1: 6
    # not a perfect match as 12 intersects the boundary
    - bus0: 12
      bus1: 13
    - bus0: 12
      bus1: 14
    B0:
    - bus0: 29
      bus1: 27
    EC5:
    - bus0: 11
      bus1: 6
    - bus0: 11
      bus1: 12
    LE1:
    - bus0: 8
      bus1: 6
    - bus0: 9
      bus1: 2
    - bus0: 4
      bus1: 8
    B13:
    - bus0: 1
      bus1: 2
    - bus0: 3
      bus1: 5
    SC1.5:
    - bus0: 2
      bus1: 1
    - bus0: 2
      bus1: 4
    - bus0: 9
      bus1: 8
    # not a perfect match as 10 intersects the boundary
    - bus0: 10
      bus1: 8
    SW1:
    - bus0: 7
      bus1: 5
    - bus0: 7
      bus1: 14
    SC2:
    - bus0: 2
      bus1: 9
    - bus0: 9
      bus1: 8
    # not a perfect match as 10 intersects the boundary
    - bus0: 10
      bus1: 8
    SC3:
    - bus0: 10
      bus1: 9
    # not a perfect match as 10 intersects the boundary
    - bus0: 10
      bus1: 8
    SC1:
    - bus0: 1
      bus1: 3
    - bus0: 2
      bus1: 4
    - bus0: 2
      bus1: 5
    - bus0: 9
      bus1: 8
    # not a perfect match as 10 intersects the boundary
    - bus0: 10
      bus1: 8
    NW2:
    - bus0: 22
      bus1: 18
    # leapfrogs NW3 - consider adding to NW3, too.
    - bus0: 17
      bus1: 22
    NW3:
    - bus0: 18
      bus1: 17
    - bus0: 15
      bus1: 18
    B14:
    - bus0: 8
      bus1: 9
    - bus0: 8
      bus1: 6
    - bus0: 8
      bus1: 10
    # Not contiguous
    - bus0: 8
      bus1: 5
    B1a:
    - bus0: 27
      bus1: 26
    - bus0: 27
      bus1: 25
    B2:
    - bus0: 26
      bus1: 25
    - bus0: 27
      bus1: 25
    NW1:
    - bus0: 22
      bus1: 31
  etys_boundaries_links:
    B6:
    - bus0: 23
      bus1: 17
    B7a:
    - bus0: 23
      bus1: 17
    B0:
    - bus0: 29
      bus1: 27

# Note: Set ENTSO_E_API_KEY in your .env file or environment variables
# Register at https://transparency.entsoe.eu/ to get API key
entsoe_unavailability:
  start_date: "2020-01-01"
  end_date: "2024-12-31"
  bidding_zones: ["GB"]  # Great Britain only
  business_types: ["planned", "forced"]  # planned maintenance and forced outages
  max_request_days: 366  # Maximum days per API request to avoid timeouts
  max_unavailable_days: 366 # Maximum days to consider an outage in availability profile generation.
  entsoe_carrier_mapping:
    Biomass: biomass
    Fossil Lignite: lignite
    Fossil Gas: CCGT
    Fossil Hard coal: coal
    Fossil Oil: oil
    Geothermal: geothermal
    Hydro Pumped Storage: PHS
    Hydro Run-of-river and poundage: hydro
    Nuclear: nuclear
    Waste: waste

transmission_availability:
  years: [2020, 2021, 2022, 2023, 2024]
  intra_gb:
    zones:
    - NGET
    - SPTL
    - SHETL
    sample_hourly: true

  inter_gb:
    zones:
    - interconnectors
    sample_hourly: false

  random_seeds:
    NGET: 11
    SPTL: 22
    SHETL: 33
    interconnectors: 44

dukes-5.11:
  # list of major power producers
  sheet-config:
    sheet_name: "DUKES 2023" # compromise sheet as it has both coal and pumped hydro data
    usecols: "A:P"
    skiprows: 5
    index_col: [0, 1]
    header: 0
  carrier_mapping:
    Technology:
      Solar: solar
      Bioenergy: biomass
      Nuclear: nuclear
      Pumped Hydro: PHS
      Pumped hydro: PHS
      Hydro: hydro
    Type:
      Onshore: onwind
      onshore: onwind
      Offshore: offwind-dc
      CCGT: CCGT
    Primary Fuel:
      Natural Gas: gas
      Diesel/Gas Oil: oil
      Coal: coal
  set_mapping:
    CHP:
      Yes: CHP
    Technology:
      Pumped Hydro: Store
      Pumped hydro: Store

grid_supply_points:
  manual_mapping:
    # Any GSPs for which direct string matches don't work, a manual mapping can be set here.
    Kirkby (_G): Kirkby ENW
    Ormonde: Ormonde (Heysham)
    Robin Rigg: Robin Rigg (Harker)
    Walney 2: Walney 2 (Heysham)
    Tynemouth 2: Tynemouth 11kV
    East Claydon (_B): East Claydon
    Grange: Margam (Grange 66kV)
    Hams Hall: Hams Hall (Lea Marston 132kV)
    Hart Moor: Hartmoor
    Tynemouth 1: Tynemouth 132kV
    Camblesforth: Camblesforth 66kV (Drax)
    Drax: Drax 132kV
    Ferrybridge B (_M): Ferrybridge B
    Fiddlers Ferry: Fiddlers Ferry (Cuerdley 132kV)
    Kirkby (_D): Kirkby SPEN
    St. Asaph: St Asaph (Bodelwyddan)
    Broadford-Skye: Broadford
    Axminster_H: Axminster H
    Clacton: Clacton (Bramford)
    Loudwater: Loudwater (Amersham)
    Sheringham Shoal: Sheringham Shoal (Norwich)
    Beddington (_C): Beddington LPN
    Canal Bank: Canal Bank (Willesden 66kV)
    Greenford: Greenford (Willesden 66kV)
    Littlebrook (_C): Littlebrook LPN
    Lodge Road: Lodge Road (St John's Wood)
    New Cross: New Cross 66kV
    Perivale: Perivale (Willesden 66kV)
    Wesley Avenue (Willesden): Wesley Avenue (Willesden 66kV)
    Beddington (_J): Beddington SPN
    Littlebrook (_J): Littlebrook SPN
    Kearsley: Kearsley 132kV
    East Claydon (_H): East Claydon
  fill-lat-lons:
    # Any GSPs defined in `gsp-coordinates` but missing lat/lon coordinates can have their coordinates manually set here.
    Stornoway: # Substation lat/lon from openinframap
      Latitude: 58.203338
      Longitude: -6.422764
    Long Park: # Longpark wind farm lat/lon
      Latitude: 55.66969
      Longitude: -2.84049
    Roosecote: # Substation lat/lon from openinframap
      Latitude: 54.10981
      Longitude: -3.20274
    New Cumnock: # Substation lat/lon from openinframap
      Latitude: 55.3445
      Longitude: -4.33503
    Port Ham: # Substation lat/lon from openinframap
      Latitude: 51.87165
      Longitude: -2.26621
fes-sheet-config:
  BB1:
    usecols: "A:C,E,G:AH" # Ignore columns: "Share of GSP" (empty), "DNO License Area"
    skiprows: 0
    index_col: [0, 1, 2, 3]
    header: 0
    rename:
      columns: year

  # Annual H2 demand, production & storage across all sectors
  WS1:
    usecols: "A:AM"
    skiprows: 7
    index_col: [0, 1, 2, 3, 4, 5, 6, 7]
    header: 0
    rename:
      columns: year

  # Annual flexibility data for 2021-2050
  FLX1:
    usecols: "E:AM"
    skiprows: 6
    index_col: [0, 1, 2, 3, 4]
    header: 0
    rename:
      columns: year

  # Annual unmanaged EV charging demand peak 2020-2050
  ED5:
    usecols: "D:AM"
    skiprows: 4
    index_col: [0, 1, 2, 3, 4]
    header: 0
    rename:
      columns: year

  BB2:
    usecols: "A:E"
    skiprows: 2
    index_col: [0, 1, 3]
    header: 0
    rename:
      columns: Parameter

  # heat technology uptake trends
  ED3:
    usecols: "C:AM"
    skiprows: 4
    index_col: [0, 1, 2, 3, 4, 5]
    header: 0
    rename:
      columns: year

  # European data
  ES2:
    usecols: "E:AM"
    skiprows: 9
    index_col: [0, 1, 2, 3, 4, 5, 6]
    header: 0
    rename:
      columns: year
fes-costing-sheet-config:

  AS.7 (Carbon Cost):
    usecols: "A:AG"
    skiprows: 6
    index_col: [0, 1]
    header: 0
    rename:
      columns: year

  AS.1 (Power Gen):
    usecols: "A:AK"
    skiprows: 6
    index_col: [0, 1, 2, 3, 4, 5]
    header: 0
    rename:
      columns: year

fes:
  fes_year: 2024
  scenario: Holistic Transition   # fes workbook
  default_set: PP
  gb:
    carrier_mapping:
      # Mapping undertaken in different columns for different carriers
      Technology:
        Biomass & Energy Crops (including CHP): biomass
        CCGTs (non CHP): CCGT
        Coal: coal
        Geothermal: geothermal
        Hydro: hydro # FIXME: should this be just "hydro?"
        Hydrogen fuelled generation: hydrogen turbine  # FIXME: something else here?
        Fuel Cells: hydrogen fuel cell
        Marine: marine
        Non-renewable Engines (Diesel) (non CHP): engine
        Non-renewable Engines (Gas) (non CHP): engine
        Non-renewable CHP: CCGT
        Nuclear: nuclear
        OCGTs (non CHP): OCGT
        Offshore-Wind (off-Grid): offwind-dc
        Renewable Engines (Landfill Gas, Sewage Gas, Biogas): biomass
        Solar Generation: solar
        Waste Incineration (including CHP): waste
      Technology Detail:
        Domestic Batteries (G98): battery
        Batteries: battery
        Pumped Hydro: PHS # FIXME: should this be just "hydro?"
        Offshore Wind: offwind-dc
        Onshore Wind <1MW: onwind
        Onshore Wind >=1MW: onwind

    set_mapping:
      Technology:
        Biomass & Energy Crops (including CHP): CHP
        Waste Incineration (including CHP): CHP
        Non-renewable CHP: CHP
        Storage: Store


    demand:
      Technology Detail:
        baseline_electricity: ["baseline demand"]
        ev: ["ev demand 1", "ev demand 2"]
        residential_heat: ["residential hp demand"]
        iandc_heat: ["i&c hp demand"]
      heat:
        electrified_heating_technologies:
          Electric resistive: resistive
          Electric storage: resistive
          Hybrid (ASHP + Electric resistive): [ASHP, resistive]
          ASHP: ASHP
          DH: [ASHP, GSHP]
          Hybrid (ASHP + Hydrogen boiler): ASHP
          Hybrid (ASHP + Biofuel boiler): ASHP
          GSHP: GSHP
      bus_suffix:
        baseline_electricity: " Baseline Electricity"
        residential: " Baseline Electricity"
        iandc: " Baseline Electricity"
        ev: " EV"
        residential_heat: " Residential Heat"
        iandc_heat: " I&C Heat"

    flexibility:
      carrier_mapping:
        battery:
          Data item: "Electricity storage energy storage potential"
          Detail: "Battery"
        ev_v2g:
          Detail: "V2G maximum potential"
        ev_dsr:
          Detail: "smart charging impact at peak"
        residential_dsr:
          Detail: "residential DSR impact at peak"
        residential_heat_dsr:
          Detail:
          - Residential peak reduction - storage heater flex
          - Residential peak reduction - hybrid heat pump flex
          - Residential peak reduction - thermal storage and district heating flex
        iandc_dsr:
          Detail: "i&c dsr impact at peak"
        iandc_heat_dsr:
          Detail:
          - Non-residential peak reduction - storage heater flex
          - Non-residential peak reduction - hybrid heat pump flex
          - Non-residential peak reduction - thermal storage and district heating flex
      dsr_hours:  # hours during which demand-side management can occur (E.g., 5pm-8pm)
        residential_heat_dsr: [0, 22]
        residential_dsr: [17, 20]
        iandc_dsr: [17, 20]
        iandc_heat_dsr: [0, 22]
        ev_dsr: [8, 6]
      carrier_suffix:
        residential: " Baseline Electricity (Residential) DSR"
        iandc: " Baseline Electricity (I&C) DSR"
        ev: " EV DSR"
        residential_heat: " Residential Heat DSR"
        iandc_heat: " I&C Heat DSR"
      v2g_storage_to_capacity_ratio: 7.14 # based on ratio in FES 2021. Same value will be applied to all future years.

    regional_distribution_reference:
      ev_dsr:
        source: "v2g"
        name: p_nom
      ev_v2g:
        source: "v2g"
        name: p_nom
      ev_peak_demand:
        source: ["ev demand 1", "ev demand 2"]
        name: p_nom
      residential_dsr:
        source: "Baseline Domestic True Demand"
        name: p_nom
      residential_heat_dsr:
        source: "residential hp demand"
        name: p_nom
      residential_heat_techs_consumption:
        source: "residential hp demand"
        name: p_set
      iandc_dsr:
        source: "i&c flexibility (tout)"
        name: p_nom
      iandc_heat_dsr:
        source: "i&c hp demand"
        name: p_nom
      iandc_heat_techs_consumption:
        source: "i&c hp demand"
        name: p_set
      non_networked_electrolysis_demand_annual:
        source: "hydrogen electrolysis"
        name: p_set
      H2_demand_annual:
        source: "hydrogen electrolysis"
        name: p_set
      H2_storage_capacity:
        source: "hydrogen electrolysis"
        name: e_nom

  eur:
    carrier_mapping:
      # Mapping undertaken in different columns for different carriers
      SubType:
        Battery: battery
        Biomass: biomass
        Biomass CCS: biomass
        Fossil Gas: CCGT
        Fossil Oil: oil
        GT Hydrogen: hydrogen turbine
        # Other RES:
        Pumped Hydro: PHS
        Run-of-river Hydro: hydro
        Solar PV: solar
        Wind Onshore: onwind
        Nuclear: nuclear
        Waste: waste
        Wind Offshore: offwind-dc
        Coal: coal
        CCGT CHP: CCGT
        Marine: marine
        Geothermal: geothermal

    set_mapping:
      SubType:
        CCGT CHP: CHP
        Battery: Store
        Pumped Hydro: Store
        Biomass CHP: CHP
        Gas CHP: CHP
        Hydrogen CHP: CHP

    totals_to_demand_groups:
      ev: [total road]
      baseline_electricity: [electricity residential, electricity services, electricity rail]
      residential_heat: [total residential space, total residential water]
      iandc_heat: [total services space, total services water]

    add_data_reference:
      # flexibility
      ev_dsr: ev
      ev_v2g: ev
      ev_v2g_storage: ev
      residential_dsr: baseline_electricity
      residential_heat_dsr: residential_heat
      residential_heat_techs_consumption: residential_heat
      iandc_dsr: baseline_electricity
      iandc_heat_dsr: iandc_heat
      iandc_heat_techs_consumption: iandc_heat
    # If not NaN, then the unconstrained load shedding generator will be set to have a marginal cost equal to that of the most expensive generator plus this value.
    # This gives us slightly more realistic European marginal prices when we have load shedding.
    load_shedding_cost_above_marginal: 1

  hydrogen:
    data_selection:
      all_supply:
        Category: supply
        Sector:
        - Methane Reformation with CCUS
        - Non-networked Electrolysis
        - Biomass gasification
        - Nuclear Electrolysis
        - Imports
        - Exports
      all_demand:
        Category: demand
        Sector:
        - Road Transport
        - Residential
        - Commercial
        - Industrial
        - Power Generation
        - Rail
        - Shipping
        - Blending
        - Aviation
        - Direct Air Carbon Capture and Storage
        - Transmission Losses
      non_networked_supply:
        Sector:
        - Non-networked Electrolysis
      storage:
        Category: Storage

    electrolysis_efficiency: 0.7 # estimate for non-networked electrolysis

ev:
  plug_in_offset: 2 # hours after the traffic/activity peak when most EVs are expected to plug in for charging
  charging_duration: 4 # duration of active charging period in hours
  ev_demand_profile_transformation:
    lower_optimization_bound: 0.001 # lower bound for gamma optimization
    upper_optimization_bound: 100 # upper bound for gamma optimization
    relative_peak_tolerance: 0.05 # 5% tolerance for peaks
    relative_energy_tolerance: 0.05 # 5% tolerance for total energy

interconnectors:
  # lat/lon values are approximate.
  # Some are based on the proposed connecting substation from the UK interconnector register.
  # Others are based on visual inspection of the TYNDP map.

  # Where the interconnection register provides a different import/export maximum, the value with one significant figure has been chosen (e.g. 1000 instead of 975, 700 instead of 730).
  options:
  - name: Nemo
    neighbour: Belgium
    capacity_mw: 1000
    tyndp:
      id: 74
      year: [2016, 2018]
    lat: 51.31128166242589
    lon: 1.3452723677851797

  - name: Cronos
    neighbour: Belgium
    capacity_mw: 1400
    tyndp:
      id: 1049
      year: [2020, 2022, 2024]
    lat: 51.36845232119477
    lon: 0.7414853093448239

  - name: Nautilus
    neighbour: Belgium
    capacity_mw: 1500
    tyndp:
      id: 121
      year: [2018, 2020, 2022, 2024]   # similar location to Cronos
    lat: 51.36845232119477
    lon: 0.7414853093448239

  - name: Viking Link
    neighbour: Denmark
    capacity_mw: 1400
    tyndp:
      id: 167
      year: [2016, 2018, 2020]
    lat: 52.921019
    lon: -0.236528

  - name: Aminth
    neighbour: Denmark
    capacity_mw: 1400
    tyndp:
      id: 1051
      year: [2020, 2022]
    lat: 52.785930
    lon: 1.603520

  - name: IFA
    neighbour: France
    capacity_mw: 2000
    tyndp:
      id:
      year: []
    lat: 50.818266
    lon: -1.194752

  - name: IFA2
    neighbour: France
    capacity_mw: 1000
    tyndp:
      id: 25
      year: [2016, 2018]
    lat: 50.818266
    lon: -1.194752

  - name: ElecLink
    neighbour: France
    capacity_mw: 1000
    tyndp:
      id: 172
      year: [2016, 2018, 2020]
    lat: 51.106623
    lon: 0.976183

  - name: Aquind
    neighbour: France
    capacity_mw: 2075
    tyndp:
      id: 247
      year: [2016, 2018, 2020, 2022, 2024]
    lat: 50.917413
    lon: -1.039947

  - name: Gridlink
    neighbour: France
    capacity_mw: 1250
    tyndp:
      id: 285
      year: [2016, 2018, 2020, 2022, 2024]
    lat: 51.418566
    lon: 0.598536

  - name: Kulizumboo
    neighbour: France
    capacity_mw: 700
    tyndp:
      id:
      year: []
    lat: 51.2946968873797
    lon: 1.0972526447850766

  - name: FAB Link
    neighbour: France
    capacity_mw: 1250
    tyndp:
      id: 153
      year: [2014, 2016, 2018, 2020, 2022, 2024]
    lat: 50.76969783229996
    lon: -3.403440324550243

  - name: NeuConnect
    neighbour: Germany
    capacity_mw: 1470
    tyndp:
      id: 309
      year: [2018, 2020, 2022, 2024]
    lat: 51.339838
    lon: 0.893931

  - name: Tarchon
    neighbour: Germany
    capacity_mw: 1400
    tyndp:
      id: 1050
      year: [2020, 2022, 2024]
    lat: 51.916412
    lon: 0.950332

  - name: East-West
    neighbour: Ireland
    capacity_mw: 585
    tyndp:
      id:
      year: []
    lat: 53.227149
    lon: -3.072706

  - name: Greenlink (Greenwire)
    neighbour: Ireland
    capacity_mw: 524
    tyndp:
      id: 286
      year: [2016, 2018, 2020, 2022]
    lat: 51.682162
    lon: -4.989479

  - name: Gallant
    neighbour: Ireland    # Northern Ireland
    capacity_mw: 500
    tyndp:
      id: 295
      year: [2016]   # Assigning same as Moyle
    lat: 55.069696
    lon: -4.980757

  - name: Moyle
    neighbour: Ireland    # Northern Ireland
    capacity_mw: 1000
    tyndp:
      id:
      year: []
    lat: 55.069696
    lon: -4.980757

  - name: MARES
    neighbour: Ireland
    capacity_mw: 750
    tyndp:
      id: 349
      year: [2018, 2020, 2022, 2024]
    lat: 53.249980
    lon: -3.474123

  - name: LirIC
    neighbour: Ireland
    capacity_mw: 700
    tyndp:
      id: 1040
      year: [2020, 2022, 2024]
    lat: 55.720041
    lon: -4.890811

  - name: BritNed
    neighbour: Netherlands
    capacity_mw: 1200
    tyndp:
      id:
      year: []
    lat: 51.440498
    lon: 0.716158

  - name: LionLink (EuroLink)
    neighbour: Netherlands
    capacity_mw: 1600
    tyndp:
      id:
      year: []
    lat: 52.208337
    lon: 1.612194

  - name: SENECA
    neighbour: Netherlands
    capacity_mw: 1254
    tyndp:
      id:
      year: []
    lat: 53.29937953918448
    lon: 0.19505891766556116

  - name: NS Link (NSL)
    neighbour: Norway
    capacity_mw: 1480
    tyndp:
      id: 110
      year: [2018, 2020]
    lat: 55.141172
    lon: -1.531373

  - name: Maali
    neighbour: Norway
    capacity_mw: 600
    tyndp:
      id: 294
      year: [2016, 2018]
    lat: 60.293767
    lon: -1.271974

  - name: NorthConnect
    neighbour: Norway
    capacity_mw: 1400
    tyndp:
      id: 190
      year: [2014, 2016, 2018, 2020, 2022]
    lat: 57.476438
    lon: -1.800696

  - name: Continental Link
    neighbour: Norway
    capacity_mw: 1800
    tyndp:
      id:
      year: []
      # "700m north of existing Creyke Beck Substation"
      # https://www.nationalgrid.com/electricity-transmission/network-and-infrastructure/infrastructure-projects/creyke-beck-substation-extension
    lat: 53.81322
    lon: -0.41847
  plan:
    2021: [BritNed, East-West, IFA, IFA2, NS Link (NSL), Nemo] # existing
    2022: [Moyle, Greenlink (Greenwire)]
    2023: [Viking Link]
    2025: [ElecLink, LionLink (EuroLink), Aminth]
    2026: [NeuConnect]
    2027: [MARES, Nautilus, Gallant, NorthConnect]
    2030: [Cronos, Tarchon]
    2033: [Kulizumboo, SENECA, FAB Link, Gridlink, LirIC]
    2037: [Continental Link]

redispatch:
  year_range_incl: [2035,2036] # 20-year period over which we will run the simulation
  constraint_cost_extra_years: 20  # number of years to extend the constraint cost calculation beyond the final year (using the data from the final year)
  # Source for bid and offers multipliers : https://www.nationalgrid.com/sites/default/files/documents/Long-term%20Market%20and%20Network%20Constraint%20Modelling.pdf
  bid_multiplier:
    gas: 0.8
    coal: 0.7
    oil: 0.38
    OCGT: 1.37
    CCGT: 0.8 #using same value as that of gas
  offer_multiplier:
    gas: 1.63
    coal: 1.56
    oil: 4.16
    OCGT: 1.31
    CCGT: 1.63 #using same value as that of gas
